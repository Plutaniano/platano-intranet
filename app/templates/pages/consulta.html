{% extends 'layouts/main.html' %}
{% block title %}Consulta{% endblock %}
{% block content %}
<script src="path_to/node_modules/tablefilter/dist/tablefilter/tablefilter.js"></script>
<form accept-charset="UTF-8" action="{{ url_for('views.consulta') }}" method="POST">
    <div class="form-group mt-3">
        {{ form.ano_mes(class_='form-control first-input', required=true) }}
        <br>
        <div {% if not current_user.is_admin %} class="hidden" {% endif %}>
        {{ form.assessores(class_='form-control', required=true) }}
        <br>
        </div>
        {{ form.tabela(class_='form-control', required=true) }}
        <br>
        <input type="submit" name="action" value="Consultar" class="btn btn-primary btn-lg">
        <input type="submit" name="action" value="Exportar" class="btn btn-primary btn-lg">
    </div>
</form>
<br>
{% if tabela %}
<table class="table table-hover table-striped table-sm">
  <thead>
    <tr>
      {% for i in tabela.showable_columns %}
      <th scope="col" class="text-center">{{ i[0].name + ' ' + i[2] }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for row in data %}
    <tr>
      {% for item in row %}
      {% set value = tabela.showable_columns[loop.index-1][1](item) %}
        <td class="text-right">{{ '' if value == None else value if value != 0 else 0 }}</td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% endblock %}